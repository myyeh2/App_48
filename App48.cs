
// ***  時頻數值計算(Time Frequency Numerical Computations)  ***  
// 微分方程式 : M(t) * yh''(t) + C(t) * yh'(t) + K(t) * yh(t) = dh 
// 稱此法為 : 實數與複數矩陣轉換( Real And Complex Matrix Transform )   
// 本求解法可對應於 Laplace、 Fourier、 Z Transform 或是 捲積積分法等等。 

using System;
using Matrix_0; 

namespace ConsoleApp48
{
    internal class Program
    {
        static void Main(string[] args)
        {

// 建構初始矩陣 M、K、C。
double[,] M0 = { { 19, -1.5, -2 }, { -1, 15, 0 }, { 0, -3, 27 } }; 
double[,] K0 = { {60, -8, -2}, {-16, 180, -120 }, {-20, -100, 300} };
double[,] C0 = { {35, -1, -0.5}, {-1.5, 40, -1.5}, {-1.2, -1.5, 75} }; 

// 轉爲SMS型態之矩陣。
ReMatrix M = new ReMatrix(M0); 
ReMatrix K = new ReMatrix(K0);
ReMatrix C = new ReMatrix(C0); 

// 狀態響應。速度，變位，加速度。(t = 20秒) 
double step = 1.0;
int iRow = (int)(20 / step + 1); 

int m = M.Row; 
int r = 2; 
int iColD = m * r + 1; 

CxMatrix CxVal = new CxMatrix(iRow, iColD); 
ReMatrix ReVal = new ReMatrix(iRow, iColD);

for (int i = 0; i != iRow; i++)
{
    double t = step * i; 

    // 建構 M、k、C 變數矩陣。
    M.Matrix[0, 2] = 13.3 * Math.Sin(0.85 * t);
    M.Matrix[2, 0] = -2.7 * Math.Cos(1.3 * t);  
    C.Matrix[0, 1] = -13.2 * Math.Sin(0.35 * t);  
    C.Matrix[2, 0] = 22.5 * Math.Cos(1.95 * t);  
    K.Matrix[0, 2] = -332 * Math.Sin(1.37 * t);  
    K.Matrix[2, 1] = 579 * Math.Cos(0.24 * t);  

    // 隨時間變化的系統(狀態)矩陣 A。  
    MKCMatrix mkc = new MKCMatrix(M, K, C);
    ReMatrix A = mkc.Matrix; 

    // 隨時間變化的系統特徵值矩陣 D 
    EIG eig = new EIG(A);
    CxMatrix D = eig.CxMatrixD;   

    // 將時間轉爲複數值。
    CxScalar cxScalar = new CxScalar(t, 0); 
    
    // 隨時間變化的特徵值矩陣。
    CxVal[i, 0] =  new CxMatrix(cxScalar); 
    CxVal[i, 1] = D[0, 0]; 
    CxVal[i, 2] = D[1, 1]; 
    CxVal[i, 3] = D[2, 2]; 
    CxVal[i, 4] = D[3, 3]; 
    CxVal[i, 5] = D[4, 4];
    CxVal[i, 6] = D[5, 5]; 

    // 隨時間變化的角矩陣。 
    ReVal.Matrix[i, 0] = i; 
    ReVal.Matrix[i, 1] = D[0, 0].Im[0, 0]; 
    ReVal.Matrix[i, 2] = D[1, 1].Im[0, 0]; 
    ReVal.Matrix[i, 3] = D[2, 2].Im[0, 0]; 
    ReVal.Matrix[i, 4] = D[3, 3].Im[0, 0]; 
    ReVal.Matrix[i, 5] = D[4, 4].Im[0, 0]; 
    ReVal.Matrix[i, 6] = D[5, 5].Im[0, 0]; 
}

Console.WriteLine("            時間(由實數值改為複數值)                 特徵值(Lambda0 ... Lambda5)       "); 
Console.WriteLine("\n{0}", new PR(CxVal)); 
Console.WriteLine("\n **********************************************************\n"); 
Console.WriteLine("\n*** 以下是時間與特徵值的模數(Modulus)[即複數的絕對值]大小排序的角頻率，共計有六組，可作為Excel繪圖 ***\n"); 
Console.WriteLine("        時間(sec)         角頻率(rad/sec)  （ w0  ...  w5  )\n");  
Console.WriteLine("\n{0} \n", new PR(ReVal)); 
Console.WriteLine("\n **********************************************************\n"); 
Console.WriteLine("\n時間序列\n{0}\n", new PR4(ReVal, 0)); 
Console.WriteLine("\n*** 以下是依據特定時間點，對應特徵值的模數(Modulus)[即複數的絕對值]大小排序，共計有六組，可作為Python 繪圖 ***\n");
Console.WriteLine("\n角頻率序列w0\n{0}\n", new PR4(ReVal, 1)); 
Console.WriteLine("\n角頻率序列w1\n{0}\n", new PR4(ReVal, 2)); 
Console.WriteLine("\n角頻率序列w2\n{0}\n", new PR4(ReVal, 3)); 
Console.WriteLine("\n角頻率序列w3\n{0}\n", new PR4(ReVal, 4)); 
Console.WriteLine("\n角頻率序列w4\n{0}\n", new PR4(ReVal, 5)); 
Console.WriteLine("\n角頻率序列w5\n{0}\n", new PR4(ReVal, 6)); 

        }
    }
}

/*輸出結果如下 : 
   時間(由實數值改為複數值)      特徵值(Lambda0 ... Lambda5)

   0.00000 +   0.00000i,   -3.21000 +   3.46438i,   -3.21000 -   3.46438i,
   0.49822 +   3.65337i,    0.49822 -   3.65337i,   -0.93205 +   1.51597i,
  -0.93205 -   1.51597i

   1.00000 +   0.00000i,   -3.35013 +   3.36847i,   -3.35013 -   3.36847i,
   0.46206 +   3.42929i,    0.46206 -   3.42929i,   -0.78699 +   1.91013i,
  -0.78699 -   1.91013i

   2.00000 +   0.00000i,   -3.43423 +   3.40458i,   -3.43423 -   3.40458i,
   0.24294 +   3.46203i,    0.24294 -   3.46203i,   -0.79501 +   1.74283i,
  -0.79501 -   1.74283i

   3.00000 +   0.00000i,   -3.05886 +   3.56061i,   -3.05886 -   3.56061i,
   0.29194 +   3.44327i,    0.29194 -   3.44327i,   -0.76658 +   1.47033i,
  -0.76658 -   1.47033i

   4.00000 +   0.00000i,   -2.87664 +   3.44383i,   -2.87664 -   3.44383i,
   0.12903 +   3.50644i,    0.12903 -   3.50644i,   -0.90128 +   1.39138i,
  -0.90128 -   1.39138i

   5.00000 +   0.00000i,   -2.70100 +   3.38700i,   -2.70100 -   3.38700i,
  -0.15010 +   3.28790i,   -0.15010 -   3.28790i,   -0.66735 +   1.65960i,
  -0.66735 -   1.65960i

   6.00000 +   0.00000i,   -1.97070 +   2.80379i,   -1.97070 -   2.80379i,
  -1.45147 +   0.86352i,   -1.45147 -   0.86352i,   -0.40136 +   3.40230i,
  -0.40136 -   3.40230i

   7.00000 +   0.00000i,   -1.20212 +   3.54723i,   -1.20212 -   3.54723i,
  -1.73600 +   2.24270i,   -1.73600 -   2.24270i,   -0.69346 +   1.70329i,
  -0.69346 -   1.70329i

   8.00000 +   0.00000i,   -1.16884 +   3.94202i,   -1.16884 -   3.94202i,
  -2.32082 +   0.72742i,   -2.32082 -   0.72742i,   -0.33440 +   2.28179i,
  -0.33440 -   2.28179i

   9.00000 +   0.00000i,   -1.29592 +   4.34861i,   -1.29592 -   4.34861i,
  -1.66918 +   1.61944i,   -1.66918 -   1.61944i,   -0.49513 +   1.21756i,
  -0.49513 -   1.21756i

  10.00000 +   0.00000i,   -1.06490 +   4.52265i,   -1.06490 -   4.52265i,
  -3.66246 +   0.00000i,   -0.83032 +   2.37958i,   -0.83032 -   2.37958i,
   0.74678 +   0.00000i

  11.00000 +   0.00000i,   -1.48404 +   4.61283i,   -1.48404 -   4.61283i,
  -3.09567 +   0.00000i,   -1.14919 +   1.92198i,   -1.14919 -   1.92198i,
   1.00071 +   0.00000i

  12.00000 +   0.00000i,   -1.24361 +   4.49676i,   -1.24361 -   4.49676i,
  -2.84470 +   0.00000i,   -2.02020 +   0.00000i,    0.14019 +   1.38514i,
   0.14019 -   1.38514i

  13.00000 +   0.00000i,   -1.51911 +   4.45419i,   -1.51911 -   4.45419i,
  -2.88462 +   1.07089i,   -2.88462 -   1.07089i,    0.50034 +   1.18121i,
   0.50034 -   1.18121i

  14.00000 +   0.00000i,   -1.34740 +   4.68863i,   -1.34740 -   4.68863i,
  -3.64215 +   0.00000i,   -0.92822 +   1.76636i,   -0.92822 -   1.76636i,
   0.88499 +   0.00000i

  15.00000 +   0.00000i,   -1.44180 +   4.56956i,   -1.44180 -   4.56956i,
  -3.62775 +   0.00000i,   -1.05291 +   2.07580i,   -1.05291 -   2.07580i,
   1.28160 +   0.00000i

  16.00000 +   0.00000i,   -1.28497 +   4.69115i,   -1.28497 -   4.69115i,
  -2.46354 +   0.00000i,   -1.00425 +   1.81506i,   -1.00425 -   1.81506i,
   0.13938 +   0.00000i

  17.00000 +   0.00000i,   -1.39381 +   4.24885i,   -1.39381 -   4.24885i,
  -2.49370 +   1.45714i,   -2.49370 -   1.45714i,    0.03368 +   1.73808i,
   0.03368 -   1.73808i

  18.00000 +   0.00000i,   -1.29256 +   4.05128i,   -1.29256 -   4.05128i,
  -1.94035 +   1.18769i,   -1.94035 -   1.18769i,   -0.51735 +   1.86161i,
  -0.51735 -   1.86161i

  19.00000 +   0.00000i,   -1.08775 +   3.62943i,   -1.08775 -   3.62943i,
  -3.10894 +   0.00000i,   -0.93659 +   2.70142i,   -0.93659 -   2.70142i,
  -0.46138 +   0.00000i

  20.00000 +   0.00000i,   -2.00354 +   2.76644i,   -2.00354 -   2.76644i,
  -0.55421 +   3.27489i,   -0.55421 -   3.27489i,   -1.26990 +   1.18921i,
  -1.26990 -   1.18921i

 **********************************************************

*** 以下是時間與特徵值的模數(Modulus)[即複數的絕對值]大小排序的角頻率，共計有六組，可作為Excel繪圖 ***
  時間(sec)    角頻率(rad/sec)  （ w0  ...  w5  )
  0.00000     3.46438  -3.46438   3.65337  -3.65337   1.51597  -1.51597
  1.00000     3.36847  -3.36847   3.42929  -3.42929   1.91013  -1.91013
  2.00000     3.40458  -3.40458   3.46203  -3.46203   1.74283  -1.74283
  3.00000     3.56061  -3.56061   3.44327  -3.44327   1.47033  -1.47033
  4.00000     3.44383  -3.44383   3.50644  -3.50644   1.39138  -1.39138
  5.00000     3.38700  -3.38700   3.28790  -3.28790   1.65960  -1.65960
  6.00000     2.80379  -2.80379   0.86352  -0.86352   3.40230  -3.40230
  7.00000     3.54723  -3.54723   2.24270  -2.24270   1.70329  -1.70329
  8.00000     3.94202  -3.94202   0.72742  -0.72742   2.28179  -2.28179
  9.00000     4.34861  -4.34861   1.61944  -1.61944   1.21756  -1.21756
 10.00000     4.52265  -4.52265   0.00000   2.37958  -2.37958   0.00000
 11.00000     4.61283  -4.61283   0.00000   1.92198  -1.92198   0.00000
 12.00000     4.49676  -4.49676   0.00000   0.00000   1.38514  -1.38514
 13.00000     4.45419  -4.45419   1.07089  -1.07089   1.18121  -1.18121
 14.00000     4.68863  -4.68863   0.00000   1.76636  -1.76636   0.00000
 15.00000     4.56956  -4.56956   0.00000   2.07580  -2.07580   0.00000
 16.00000     4.69115  -4.69115   0.00000   1.81506  -1.81506   0.00000
 17.00000     4.24885  -4.24885   1.45714  -1.45714   1.73808  -1.73808
 18.00000     4.05128  -4.05128   1.18769  -1.18769   1.86161  -1.86161
 19.00000     3.62943  -3.62943   0.00000   2.70142  -2.70142   0.00000
 20.00000     2.76644  -2.76644   3.27489  -3.27489   1.18921  -1.18921

 **********************************************************

時間序列
   0.0000,   1.0000,   2.0000,   3.0000,   4.0000,
   5.0000,   6.0000,   7.0000,   8.0000,   9.0000,
  10.0000,  11.0000,  12.0000,  13.0000,  14.0000,
  15.0000,  16.0000,  17.0000,  18.0000,  19.0000,
  20.0000,

*** 以下是依據特定時間點，對應特徵值的模數(Modulus)[即複數的絕對值]大小排序，共計有六組，可作為Python 繪圖 ***

角頻率序列w0
   3.4644,   3.3685,   3.4046,   3.5606,   3.4438,
   3.3870,   2.8038,   3.5472,   3.9420,   4.3486,
   4.5226,   4.6128,   4.4968,   4.4542,   4.6886,
   4.5696,   4.6911,   4.2488,   4.0513,   3.6294,
   2.7664,

角頻率序列w1
  -3.4644,  -3.3685,  -3.4046,  -3.5606,  -3.4438,
  -3.3870,  -2.8038,  -3.5472,  -3.9420,  -4.3486,
  -4.5226,  -4.6128,  -4.4968,  -4.4542,  -4.6886,
  -4.5696,  -4.6911,  -4.2488,  -4.0513,  -3.6294,
  -2.7664,

角頻率序列w2
   3.6534,   3.4293,   3.4620,   3.4433,   3.5064,
   3.2879,   0.8635,   2.2427,   0.7274,   1.6194,
   0.0000,   0.0000,   0.0000,   1.0709,   0.0000,
   0.0000,   0.0000,   1.4571,   1.1877,   0.0000,
   3.2749,

角頻率序列w3
  -3.6534,  -3.4293,  -3.4620,  -3.4433,  -3.5064,
  -3.2879,  -0.8635,  -2.2427,  -0.7274,  -1.6194,
   2.3796,   1.9220,   0.0000,  -1.0709,   1.7664,
   2.0758,   1.8151,  -1.4571,  -1.1877,   2.7014,
  -3.2749,

角頻率序列w4
   1.5160,   1.9101,   1.7428,   1.4703,   1.3914,
   1.6596,   3.4023,   1.7033,   2.2818,   1.2176,
  -2.3796,  -1.9220,   1.3851,   1.1812,  -1.7664,
  -2.0758,  -1.8151,   1.7381,   1.8616,  -2.7014,
   1.1892,

角頻率序列w5
  -1.5160,  -1.9101,  -1.7428,  -1.4703,  -1.3914,
  -1.6596,  -3.4023,  -1.7033,  -2.2818,  -1.2176,
   0.0000,   0.0000,  -1.3851,  -1.1812,   0.0000,
   0.0000,   0.0000,  -1.7381,  -1.8616,   0.0000,
  -1.1892,

請按任意鍵繼續 . . .
*/